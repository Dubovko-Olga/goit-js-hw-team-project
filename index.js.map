{"version":3,"file":"index.js","sources":["../src/js/books/api.js","../src/js/books/render-functions.js","../src/js/books/books.js"],"sourcesContent":["import axios from 'axios';\n\nconst base = 'https://books-backend.p.goit.global/books/';\nexport async function getCategories() {\n  const response = await axios(`${base}category-list`);\n  return response.data;\n}\n\nexport async function getAllBooks() {\n  const response = await axios(`${base}top-books`);\n  return response.data;\n}\n\nexport async function getBookByCat(category) {\n  const response = await axios(\n    `${base}category?category=${encodeURIComponent(category.trim())}`\n  );\n  return response.data;\n}\n\nexport async function getBookById(id) {\n  const response = await axios(`${base}${id}`);\n  return response.data;\n}\n","import { getAllBooks, getCategories, getBookByCat, getBookById } from './api';\n\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst counter = document.querySelector('.counter');\n\nlet allBooks = [];\nlet currentBooks = [];\nlet currentIndex = 0;\nlet selectedCategory = 'All categories';\nlet allCategories = [];\n\nconst LOAD_MORE_COUNT = 4;\nlet isMobileView = window.innerWidth < 1440;\n\nexport async function createCategories() {\n  try {\n    if (allCategories.length === 0) {\n      const categories = await getCategories();\n\n      const validCategories = categories.filter(\n        cat => cat.list_name && cat.list_name.trim() !== ''\n      );\n\n      allCategories = [{ list_name: 'All categories' }, ...validCategories];\n    }\n\n    const select = document.querySelector('#categories-select');\n    const categoriesList = document.querySelector('.categories-list');\n\n    select.innerHTML = '';\n    categoriesList.innerHTML = '';\n\n    const isMobile = window.innerWidth < 1440;\n\n    if (isMobile) {\n      allCategories.forEach(cat => {\n        const option = document.createElement('option');\n        option.value = cat.list_name;\n        option.textContent = cat.list_name;\n        select.appendChild(option);\n      });\n\n      select.addEventListener('change', async e => {\n        selectedCategory = e.target.value;\n\n        if (selectedCategory === 'All categories') {\n          renderBooks(allBooks);\n        } else {\n          try {\n            const data = await getBookByCat(selectedCategory);\n            renderBooks(data);\n          } catch (error) {\n            console.error('Error loading category books:', error);\n          }\n        }\n      });\n\n      if (allBooks.length > 0) {\n        renderBooks(allBooks);\n      } else {\n        const data = await getAllBooks();\n        allBooks = data.flatMap(cat => cat.books);\n        renderBooks(allBooks);\n      }\n    } else {\n      const markup = allCategories\n        .filter(cat => cat.list_name && cat.list_name.trim() !== '')\n        .map(\n          cat => `\n            <li class=\"category-item ${\n              cat.list_name === 'All categories' ? 'active' : ''\n            }\">${cat.list_name}</li>`\n        )\n        .join('');\n\n      categoriesList.insertAdjacentHTML('beforeend', markup);\n      categoriesList.addEventListener('click', onCategoryClick);\n\n      if (allBooks.length > 0) {\n        renderBooks(allBooks);\n      } else {\n        const data = await getAllBooks();\n        allBooks = data.flatMap(cat => cat.books);\n        renderBooks(allBooks);\n      }\n    }\n  } catch (error) {\n    console.error('Error loading categories:', error);\n  }\n}\n\nexport async function createBooks() {\n  try {\n    const data = await getAllBooks();\n    allBooks = data.flatMap(category => category.books);\n    selectedCategory = 'All categories';\n    renderBooks(allBooks);\n  } catch (error) {\n    console.error('Error loading books:', error);\n  }\n}\n\nfunction renderBooks(books) {\n  currentBooks = books;\n  currentIndex = 0;\n  gallery.innerHTML = '';\n  const initialCount = window.innerWidth < 768 ? 10 : 24;\n  renderNextBooks(initialCount);\n}\n\nfunction renderNextBooks(count) {\n  const nextBooks = currentBooks.slice(currentIndex, currentIndex + count);\n\n  if (nextBooks.length === 0) {\n    loadMoreBtn.style.display = 'none';\n    return;\n  }\n\n  const markup = nextBooks\n    .map(\n      ({ author, title, book_image, price = '10.00' }) => `\n      <li class=\"gallery-item\">\n        <img src=\"${book_image}\" alt=\"${title}\">\n        <div class = 'book-header'>\n        <p class=\"book-title\">${title}</p>\n        <p class=\"book-price\">$${price === '0.00' ? '10.00' : price}</p>\n        </div>\n        <p class=\"book-author\">${author}</p>\n        \n        \n        <button class=\"learn-more\">Learn More</button>\n      </li>`\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n  currentIndex += count;\n\n  loadMoreBtn.style.display =\n    currentIndex >= currentBooks.length ? 'none' : 'block';\n\n  updateCounter();\n  addLearnMoreListeners();\n}\n\nfunction updateCounter() {\n  counter.textContent = `Showing ${Math.min(\n    currentIndex,\n    currentBooks.length\n  )} from ${currentBooks.length}`;\n}\n\nexport function onLoadMore() {\n  renderNextBooks(LOAD_MORE_COUNT);\n  smoothScroll();\n}\n\nexport async function onCategoryClick(event) {\n  const clicked = event.target;\n  if (!clicked.classList.contains('category-item')) return;\n\n  const category = clicked.textContent.trim();\n  selectedCategory = category;\n\n  document\n    .querySelectorAll('.category-item')\n    .forEach(item => item.classList.remove('active'));\n  clicked.classList.add('active');\n\n  if (category === 'All categories') {\n    renderBooks(allBooks);\n    return;\n  }\n\n  try {\n    const data = await getBookByCat(category);\n    renderBooks(data);\n  } catch (error) {\n    console.error('Error loading category books:', error);\n  }\n}\n\nwindow.addEventListener('resize', () => {\n  const newIsMobile = window.innerWidth < 1440;\n  if (newIsMobile !== isMobileView) {\n    isMobileView = newIsMobile;\n    createCategories();\n  }\n});\nfunction addLearnMoreListeners() {\n  const buttons = document.querySelectorAll('.learn-more');\n\n  buttons.forEach((btn, index) => {\n    btn.addEventListener('click', async () => {\n      try {\n        const book = currentBooks[index];\n        const fullBookData = await getBookById(book._id);\n\n        console.log(fullBookData);\n      } catch (error) {\n        console.error('Error fetching book by ID:', error);\n      }\n    });\n  });\n}\n\nfunction smoothScroll() {\n  const { height } = document\n    .querySelector('.gallery-item')\n    .getBoundingClientRect();\n\n  window.scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n","import {\n  createBooks,\n  createCategories,\n  onLoadMore,\n  onCategoryClick,\n} from './render-functions';\n\ncreateCategories();\ncreateBooks();\n\nconst category = document.querySelector('.categories');\nconst loadMoreBtn = document.querySelector('.load-more');\n\ncategory.addEventListener('click', onCategoryClick);\nloadMoreBtn.addEventListener('click', onLoadMore);\n"],"names":["base","getCategories","axios","getAllBooks","getBookByCat","category","getBookById","id","gallery","loadMoreBtn","counter","allBooks","currentBooks","currentIndex","selectedCategory","allCategories","LOAD_MORE_COUNT","isMobileView","createCategories","validCategories","cat","select","categoriesList","option","e","renderBooks","data","error","markup","onCategoryClick","createBooks","books","initialCount","renderNextBooks","count","nextBooks","author","title","book_image","price","updateCounter","addLearnMoreListeners","onLoadMore","smoothScroll","event","clicked","item","newIsMobile","btn","index","book","fullBookData","height"],"mappings":"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"}